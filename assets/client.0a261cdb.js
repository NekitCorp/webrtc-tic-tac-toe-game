import{R as x,S as D,i as R,s as T,L,c as C,m as k,t as m,a as g,d as y,b as $,e as A,f as w,g as E,h as P,j as b,k as d,l as v,n as I,p,q as f,r as N,u as h,C as O,A as q,y as W,z as j}from"./global.3e6b7d03.js";class z extends x{connectToDataChannel(e){this.setRemoteDescription(e),this.peerConnection.createAnswer().then(t=>{console.log("[CREATE ANSWER]",t),this.peerConnection.setLocalDescription(t).then(()=>{console.log("[SET LOCAL DESCRIPTION]")},n=>{console.error("setLocalDescription failed",n)})},t=>{console.error("createAnswer failed",t)})}}function B(c){let e,t,n,o,r;return{c(){e=d("div"),t=d("h1"),t.textContent="Wrong connection state",n=v(),o=d("p"),r=I(c[0]),p(t,"class","dialog-text"),p(o,"class","dialog-text"),p(e,"class","standard-dialog center")},m(a,i){w(a,e,i),f(e,t),f(e,n),f(e,o),f(o,r)},p(a,i){i&1&&N(r,a[0])},i:h,o:h,d(a){a&&b(e)}}}function F(c){let e,t;return e=new O({props:{messages:c[2]}}),e.$on("send",c[6]),{c(){C(e.$$.fragment)},m(n,o){k(e,n,o),t=!0},p(n,o){const r={};o&4&&(r.messages=n[2]),e.$set(r)},i(n){t||(m(e.$$.fragment,n),t=!0)},o(n){g(e.$$.fragment,n),t=!1},d(n){y(e,n)}}}function M(c){let e,t,n,o,r,a,i;return{c(){e=d("div"),t=d("h1"),t.textContent="Send your local offer to player #1",n=v(),o=d("textarea"),p(t,"class","dialog-text"),p(o,"rows",10),q(o,"width","100%"),o.value=r=window.btoa(c[1]),p(e,"class","standard-dialog center")},m(s,l){w(s,e,l),f(e,t),f(e,n),f(e,o),a||(i=W(j.call(null,o)),a=!0)},p(s,l){l&2&&r!==(r=window.btoa(s[1]))&&(o.value=r)},i:h,o:h,d(s){s&&b(e),a=!1,i()}}}function U(c){let e,t,n,o;const r=[M,F,B],a=[];function i(s,l){return s[0]==="connecting"?0:s[0]==="connected"?1:2}return e=i(c),t=a[e]=r[e](c),{c(){t.c(),n=A()},m(s,l){a[e].m(s,l),w(s,n,l),o=!0},p(s,l){let _=e;e=i(s),e===_?a[e].p(s,l):(E(),g(a[_],1,1,()=>{a[_]=null}),P(),t=a[e],t?t.p(s,l):(t=a[e]=r[e](s),t.c()),m(t,1),t.m(n.parentNode,n))},i(s){o||(m(t),o=!0)},o(s){g(t),o=!1},d(s){a[e].d(s),s&&b(n)}}}function G(c){let e,t;return e=new L({props:{$$slots:{default:[U]},$$scope:{ctx:c}}}),{c(){C(e.$$.fragment)},m(n,o){k(e,n,o),t=!0},p(n,[o]){const r={};o&519&&(r.$$scope={dirty:o,ctx:n}),e.$set(r)},i(n){t||(m(e.$$.fragment,n),t=!0)},o(n){g(e.$$.fragment,n),t=!1},d(n){y(e,n)}}}function H(c,e,t){let n,o,r;const a=new z,{localDescription:i,messages:s,connectionState:l}=a;$(c,i,u=>t(1,o=u)),$(c,s,u=>t(2,r=u)),$(c,l,u=>t(0,n=u));const _=new URLSearchParams(window.location.search);a.connectToDataChannel(window.atob(_.get("offer")));function S(u){u.detail&&a.sendMessage(u.detail)}return[n,o,r,i,s,l,S]}class J extends D{constructor(e){super(),R(this,e,H,G,T,{})}}new J({target:document.getElementById("app")});
