var X=Object.defineProperty;var Y=(e,t,n)=>t in e?X(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n;var f=(e,t,n)=>(Y(e,typeof t!="symbol"?t+"":t,n),n);(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))s(o);new MutationObserver(o=>{for(const r of o)if(r.type==="childList")for(const i of r.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&s(i)}).observe(document,{childList:!0,subtree:!0});function n(o){const r={};return o.integrity&&(r.integrity=o.integrity),o.referrerpolicy&&(r.referrerPolicy=o.referrerpolicy),o.crossorigin==="use-credentials"?r.credentials="include":o.crossorigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function s(o){if(o.ep)return;o.ep=!0;const r=n(o);fetch(o.href,r)}})();function h(){}function Z(e,t){for(const n in t)e[n]=t[n];return e}function B(e){return e()}function M(){return Object.create(null)}function _(e){e.forEach(B)}function H(e){return typeof e=="function"}function I(e,t){return e!=e?t==t:e!==t||e&&typeof e=="object"||typeof e=="function"}function ee(e){return Object.keys(e).length===0}function te(e,...t){if(e==null)return h;const n=e.subscribe(...t);return n.unsubscribe?()=>n.unsubscribe():n}function De(e,t,n){e.$$.on_destroy.push(te(t,n))}function ne(e,t,n,s){if(e){const o=K(e,t,n,s);return e[0](o)}}function K(e,t,n,s){return e[1]&&s?Z(n.ctx.slice(),e[1](s(t))):n.ctx}function oe(e,t,n,s){if(e[2]&&s){const o=e[2](s(n));if(t.dirty===void 0)return o;if(typeof o=="object"){const r=[],i=Math.max(t.dirty.length,o.length);for(let a=0;a<i;a+=1)r[a]=t.dirty[a]|o[a];return r}return t.dirty|o}return t.dirty}function se(e,t,n,s,o,r){if(o){const i=K(t,n,s,r);e.p(i,o)}}function re(e){if(e.ctx.length>32){const t=[],n=e.ctx.length/32;for(let s=0;s<n;s++)t[s]=-1;return t}return-1}function $e(e){return e&&H(e.destroy)?e.destroy:h}function v(e,t){e.appendChild(t)}function x(e,t,n){e.insertBefore(t,n||null)}function S(e){e.parentNode.removeChild(e)}function C(e){return document.createElement(e)}function R(e){return document.createTextNode(e)}function k(){return R(" ")}function ve(){return R("")}function q(e,t,n,s){return e.addEventListener(t,n,s),()=>e.removeEventListener(t,n,s)}function p(e,t,n){n==null?e.removeAttribute(t):e.getAttribute(t)!==n&&e.setAttribute(t,n)}function ie(e){return Array.from(e.childNodes)}function ce(e,t){t=""+t,e.wholeText!==t&&(e.data=t)}function z(e,t){e.value=t==null?"":t}function Ee(e,t,n,s){n===null?e.style.removeProperty(t):e.style.setProperty(t,n,s?"important":"")}function ae(e,t,{bubbles:n=!1,cancelable:s=!1}={}){const o=document.createEvent("CustomEvent");return o.initCustomEvent(e,n,s,t),o}let $;function D(e){$=e}function G(){if(!$)throw new Error("Function called outside component initialization");return $}function we(e){G().$$.on_mount.push(e)}function le(){const e=G();return(t,n,{cancelable:s=!1}={})=>{const o=e.$$.callbacks[t];if(o){const r=ae(t,n,{cancelable:s});return o.slice().forEach(i=>{i.call(e,r)}),!r.defaultPrevented}return!0}}const b=[],F=[],L=[],J=[],ue=Promise.resolve();let T=!1;function fe(){T||(T=!0,ue.then(Q))}function N(e){L.push(e)}const A=new Set;let E=0;function Q(){const e=$;do{for(;E<b.length;){const t=b[E];E++,D(t),de(t.$$)}for(D(null),b.length=0,E=0;F.length;)F.pop()();for(let t=0;t<L.length;t+=1){const n=L[t];A.has(n)||(A.add(n),n())}L.length=0}while(b.length);for(;J.length;)J.pop()();T=!1,A.clear(),D(e)}function de(e){if(e.fragment!==null){e.update(),_(e.before_update);const t=e.dirty;e.dirty=[-1],e.fragment&&e.fragment.p(e.ctx,t),e.after_update.forEach(N)}}const O=new Set;let m;function xe(){m={r:0,c:[],p:m}}function Le(){m.r||_(m.c),m=m.p}function U(e,t){e&&e.i&&(O.delete(e),e.i(t))}function he(e,t,n,s){if(e&&e.o){if(O.has(e))return;O.add(e),m.c.push(()=>{O.delete(e),s&&(n&&e.d(1),s())}),e.o(t)}else s&&s()}function Oe(e){e&&e.c()}function pe(e,t,n,s){const{fragment:o,on_mount:r,on_destroy:i,after_update:a}=e.$$;o&&o.m(t,n),s||N(()=>{const l=r.map(B).filter(H);i?i.push(...l):_(l),e.$$.on_mount=[]}),a.forEach(N)}function me(e,t){const n=e.$$;n.fragment!==null&&(_(n.on_destroy),n.fragment&&n.fragment.d(t),n.on_destroy=n.fragment=null,n.ctx=[])}function ge(e,t){e.$$.dirty[0]===-1&&(b.push(e),fe(),e.$$.dirty.fill(0)),e.$$.dirty[t/31|0]|=1<<t%31}function V(e,t,n,s,o,r,i,a=[-1]){const l=$;D(e);const c=e.$$={fragment:null,ctx:null,props:r,update:h,not_equal:o,bound:M(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(t.context||(l?l.$$.context:[])),callbacks:M(),dirty:a,skip_bound:!1,root:t.target||l.$$.root};i&&i(c.root);let y=!1;if(c.ctx=n?n(e,t.props||{},(u,d,...P)=>{const j=P.length?P[0]:d;return c.ctx&&o(c.ctx[u],c.ctx[u]=j)&&(!c.skip_bound&&c.bound[u]&&c.bound[u](j),y&&ge(e,u)),d}):[],c.update(),y=!0,_(c.before_update),c.fragment=s?s(c.ctx):!1,t.target){if(t.hydrate){const u=ie(t.target);c.fragment&&c.fragment.l(u),u.forEach(S)}else c.fragment&&c.fragment.c();t.intro&&U(e.$$.fragment),pe(e,t.target,t.anchor,t.customElement),Q()}D(l)}class W{$destroy(){me(this,1),this.$destroy=h}$on(t,n){const s=this.$$.callbacks[t]||(this.$$.callbacks[t]=[]);return s.push(n),()=>{const o=s.indexOf(n);o!==-1&&s.splice(o,1)}}$set(t){this.$$set&&!ee(t)&&(this.$$.skip_bound=!0,this.$$set(t),this.$$.skip_bound=!1)}}const g=[];function w(e,t=h){let n;const s=new Set;function o(a){if(I(e,a)&&(e=a,n)){const l=!g.length;for(const c of s)c[1](),g.push(c,e);if(l){for(let c=0;c<g.length;c+=2)g[c][0](g[c+1]);g.length=0}}}function r(a){o(a(e))}function i(a,l=h){const c=[a,l];return s.add(c),s.size===1&&(n=t(o)||h),a(e),()=>{s.delete(c),s.size===0&&(n(),n=null)}}return{set:o,update:r,subscribe:i}}class Ae{constructor(){f(this,"peerConnection",new RTCPeerConnection({iceServers:[{urls:"stun:stun.l.google.com:19302"}]}));f(this,"dataChannel",null);f(this,"localDescription",w(""));f(this,"messages",w([]));f(this,"connectionState",w(this.peerConnection.connectionState));f(this,"iceConnectionState",w(this.peerConnection.iceConnectionState));f(this,"handleIceCandidate",t=>{console.log("[HANDLE ICE CANDIDATE]",t),t.candidate===null&&this.localDescription.set(JSON.stringify(this.peerConnection.localDescription))});f(this,"handleConnectionStateChange",t=>{const n=t.target.connectionState;console.log("handleConnectionStateChange",n),this.connectionState.set(n)});f(this,"handleIceConnectionStateChange",t=>{const n=t.target.iceConnectionState;console.log("handleIceConnectionStateChange",n),this.iceConnectionState.set(n)});f(this,"handleDataChannel",t=>this.setDataChannel(t.channel));f(this,"setDataChannel",t=>{this.dataChannel=t,this.dataChannel.onopen=this.handleDataChannelOpen,this.dataChannel.onmessage=this.handleDataChannelMessage});f(this,"handleDataChannelOpen",t=>console.log("dataChannel open",t));f(this,"handleDataChannelMessage",t=>{console.log("dataChannel message",t),this.messages.update(n=>[...n,`[${new Date().toLocaleString()}] ${t.data}`])});this.peerConnection.onicecandidate=this.handleIceCandidate,this.peerConnection.onconnectionstatechange=this.handleConnectionStateChange,this.peerConnection.oniceconnectionstatechange=this.handleIceConnectionStateChange,this.peerConnection.ondatachannel=this.handleDataChannel}setRemoteDescription(t){return this.peerConnection.setRemoteDescription(new RTCSessionDescription(JSON.parse(t))).then(()=>{console.log("[SET REMOTE DESCRIPTION]",t)},n=>{console.error("setRemoteDescription failed",n)})}connectToDataChannel(t){this.setRemoteDescription(t),this.peerConnection.createAnswer().then(n=>{console.log("createAnswer done",n),this.peerConnection.setLocalDescription(n).then(()=>{console.log("setLocalDescription done")},s=>{console.error("setLocalDescription failed",s)})},n=>{console.error("createAnswer failed",n)})}sendMessage(t){this.dataChannel.send(t),this.messages.update(n=>[...n,`[${new Date().toLocaleString()}] ${t}`])}}function Te(e){const t=()=>{e&&typeof e.select=="function"&&e.select()};return e.addEventListener("focus",t),{destroy(){e.removeEventListener("focus",t)}}}function _e(e){let t,n=e[0].join(`
`)+"",s,o,r,i,a,l,c,y;return{c(){t=C("div"),s=R(n),o=k(),r=C("form"),i=C("input"),a=k(),l=C("button"),l.textContent="Send message",p(t,"class","standard-dialog center chat svelte-7lsohs"),p(i,"type","text"),p(i,"class","input svelte-7lsohs"),p(i,"placeholder","Type your message here"),p(l,"class","btn"),p(l,"type","submit")},m(u,d){x(u,t,d),v(t,s),x(u,o,d),x(u,r,d),v(r,i),z(i,e[1]),v(r,a),v(r,l),c||(y=[q(i,"input",e[3]),q(r,"submit",e[2])],c=!0)},p(u,[d]){d&1&&n!==(n=u[0].join(`
`)+"")&&ce(s,n),d&2&&i.value!==u[1]&&z(i,u[1])},i:h,o:h,d(u){u&&S(t),u&&S(o),u&&S(r),c=!1,_(y)}}}function ye(e,t,n){let{messages:s}=t,o="";const r=le(),i=l=>{l.preventDefault(),r("send",o),n(1,o="")};function a(){o=this.value,n(1,o)}return e.$$set=l=>{"messages"in l&&n(0,s=l.messages)},[s,o,i,a]}class Ne extends W{constructor(t){super(),V(this,t,ye,_e,I,{messages:0})}}function Ce(e){let t,n;const s=e[1].default,o=ne(s,e,e[0],null);return{c(){t=C("main"),o&&o.c(),p(t,"class","svelte-1yrdh9e")},m(r,i){x(r,t,i),o&&o.m(t,null),n=!0},p(r,[i]){o&&o.p&&(!n||i&1)&&se(o,s,r,r[0],n?oe(s,r[0],i,null):re(r[0]),null)},i(r){n||(U(o,r),n=!0)},o(r){he(o,r),n=!1},d(r){r&&S(t),o&&o.d(r)}}}function be(e,t,n){let{$$slots:s={},$$scope:o}=t;return e.$$set=r=>{"$$scope"in r&&n(0,o=r.$$scope)},[o,s]}class Ie extends W{constructor(t){super(),V(this,t,be,Ce,I,{})}}export{Ee as A,Ne as C,Ie as L,Ae as R,W as S,he as a,De as b,Oe as c,me as d,ve as e,x as f,xe as g,Le as h,V as i,S as j,C as k,k as l,pe as m,R as n,we as o,p,v as q,ce as r,I as s,U as t,h as u,z as v,q as w,_ as x,$e as y,Te as z};
