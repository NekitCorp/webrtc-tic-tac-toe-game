import{R as G,S as F,i as H,s as P,L as q,c as S,m as D,t as b,a as k,d as x,b as y,G as B,o as N,e as j,f as C,g as z,h as W,j as w,C as J,k as d,l as v,n as K,p as _,q as u,r as Q,u as m,v as U,w as V,x as O,y as R,z as X,A as Y,B as Z}from"./global.2a6201d3.js";class ee extends G{createDataChannel(e="sendDataChannel"){this.setDataChannel(this.peerConnection.createDataChannel(e)),this.peerConnection.createOffer().then(t=>{console.log("[CREATE OFFER]",t),this.peerConnection.setLocalDescription(t).then(()=>{console.log("[SET LOCAL DESCRIPTION]")},s=>{console.error("setLocalDescription failed",s)})},t=>{console.error("createOffer failed",t)})}}function te(r){let e,t,s,n,l;return{c(){e=d("div"),t=d("h1"),t.textContent="Wrong connection state",s=v(),n=d("p"),l=K(r[2]),_(t,"class","dialog-text"),_(n,"class","dialog-text"),_(e,"class","standard-dialog center")},m(a,i){C(a,e,i),u(e,t),u(e,s),u(e,n),u(n,l)},p(a,i){i&4&&Q(l,a[2])},i:m,o:m,d(a){a&&w(e)}}}function ne(r){let e,t,s,n,l;return t=new U({props:{state:r[5]}}),t.$on("send",r[9]),n=new V({props:{messages:r[3]}}),n.$on("send",r[10]),{c(){e=d("div"),S(t.$$.fragment),s=v(),S(n.$$.fragment),_(e,"class","game animate__animated animate__backInLeft svelte-1o6k52l")},m(a,i){C(a,e,i),D(t,e,null),u(e,s),D(n,e,null),l=!0},p(a,i){const o={};i&8&&(o.messages=a[3]),n.$set(o)},i(a){l||(b(t.$$.fragment,a),b(n.$$.fragment,a),l=!0)},o(a){k(t.$$.fragment,a),k(n.$$.fragment,a),l=!1},d(a){a&&w(e),x(t),x(n)}}}function ae(r){let e,t,s,n,l,a,i,o;return{c(){e=d("div"),t=d("h1"),t.textContent='Then, paste the "answer" you received',s=v(),n=d("textarea"),l=v(),a=d("button"),a.textContent="Okay, I pasted it.",_(t,"class","dialog-text"),_(n,"rows",10),_(a,"class","btn svelte-1o6k52l"),_(e,"class","standard-dialog center animate__animated animate__backInLeft")},m(c,p){C(c,e,p),u(e,t),u(e,s),u(e,n),O(n,r[0]),u(e,l),u(e,a),i||(o=[R(n,"input",r[12]),R(a,"click",r[8])],i=!0)},p(c,p){p&1&&O(n,c[0])},i:m,o:m,d(c){c&&w(e),i=!1,X(o)}}}function se(r){let e,t,s,n,l,a;return{c(){e=d("div"),t=d("h1"),t.textContent="Send link to player #2",s=v(),n=d("textarea"),_(t,"class","dialog-text"),_(n,"rows",10),n.value=r[1],_(e,"class","standard-dialog center animate__animated animate__backInLeft")},m(i,o){C(i,e,o),u(e,t),u(e,s),u(e,n),l||(a=Y(Z.call(null,n)),l=!0)},p(i,o){o&2&&(n.value=i[1])},i:m,o:m,d(i){i&&w(e),l=!1,a()}}}function oe(r){let e,t,s,n;const l=[se,ae,ne,te],a=[];function i(o,c){return o[2]==="new"?0:o[2]==="connecting"?1:o[2]==="connected"?2:3}return e=i(r),t=a[e]=l[e](r),{c(){t.c(),s=j()},m(o,c){a[e].m(o,c),C(o,s,c),n=!0},p(o,c){let p=e;e=i(o),e===p?a[e].p(o,c):(z(),k(a[p],1,1,()=>{a[p]=null}),W(),t=a[e],t?t.p(o,c):(t=a[e]=l[e](o),t.c()),b(t,1),t.m(s.parentNode,s))},i(o){n||(b(t),n=!0)},o(o){k(t),n=!1},d(o){a[e].d(o),o&&w(s)}}}function re(r){let e,t;return e=new q({props:{$$slots:{default:[oe]},$$scope:{ctx:r}}}),{c(){S(e.$$.fragment)},m(s,n){D(e,s,n),t=!0},p(s,[n]){const l={};n&65551&&(l.$$scope={dirty:n,ctx:s}),e.$set(l)},i(s){t||(b(e.$$.fragment,s),t=!0)},o(s){k(e.$$.fragment,s),t=!1},d(s){x(e,s)}}}function le(r,e,t){let s,n,l,a;const i=new J,{messages:o}=i;y(r,o,f=>t(3,a=f));const c=new B(1),{state:p}=c,g=new ee(i,c),{localDescription:L,connectionState:E}=g;y(r,L,f=>t(11,n=f)),y(r,E,f=>t(2,l=f));let h="";function I(){h&&g.setRemoteDescription(atob(h))}function T(f){if(f.detail){const $=f.detail;c.send($),g.sendMessage({type:"game",event:$})}}function M(f){if(f.detail){const $=f.detail;i.addMessage($),g.sendMessage({type:"chat",text:$})}}N(()=>{g.createDataChannel()});function A(){h=this.value,t(0,h)}return r.$$.update=()=>{r.$$.dirty&2048&&t(1,s=`${window.location.href}client.html?offer=${window.btoa(n)}`)},[h,s,l,a,o,p,L,E,I,T,M,n,A]}class ie extends F{constructor(e){super(),H(this,e,le,re,P,{})}}new ie({target:document.getElementById("app")});
