import{R as I,S as F,i as H,s as P,L as q,c as S,m as D,t as C,a as b,d as x,b as y,G as B,o as N,e as j,f as k,g as z,h as W,j as w,C as J,k as d,l as v,n as K,p,q as u,r as Q,u as m,v as U,w as V,x as R,y as T,z as X,A as Y,B as Z}from"./global.b6f67fdc.js";class ee extends I{createDataChannel(e="sendDataChannel"){this.setDataChannel(this.peerConnection.createDataChannel(e)),this.peerConnection.createOffer().then(t=>{console.log("[CREATE OFFER]",t),this.peerConnection.setLocalDescription(t).then(()=>{console.log("[SET LOCAL DESCRIPTION]")},n=>{console.error("setLocalDescription failed",n)})},t=>{console.error("createOffer failed",t)})}}function te(l){let e,t,n,s,a;return{c(){e=d("div"),t=d("h1"),t.textContent="Wrong connection state",n=v(),s=d("p"),a=K(l[2]),p(t,"class","dialog-text"),p(s,"class","dialog-text"),p(e,"class","standard-dialog center")},m(o,c){k(o,e,c),u(e,t),u(e,n),u(e,s),u(s,a)},p(o,c){c&4&&Q(a,o[2])},i:m,o:m,d(o){o&&w(e)}}}function ne(l){let e,t,n,s;return e=new U({props:{state:l[5]}}),e.$on("send",l[9]),n=new V({props:{messages:l[3]}}),n.$on("send",l[10]),{c(){S(e.$$.fragment),t=v(),S(n.$$.fragment)},m(a,o){D(e,a,o),k(a,t,o),D(n,a,o),s=!0},p(a,o){const c={};o&8&&(c.messages=a[3]),n.$set(c)},i(a){s||(C(e.$$.fragment,a),C(n.$$.fragment,a),s=!0)},o(a){b(e.$$.fragment,a),b(n.$$.fragment,a),s=!1},d(a){x(e,a),a&&w(t),x(n,a)}}}function se(l){let e,t,n,s,a,o,c,r;return{c(){e=d("div"),t=d("h1"),t.textContent='Then, paste the "answer" you received',n=v(),s=d("textarea"),a=v(),o=d("button"),o.textContent="Okay, I pasted it.",p(t,"class","dialog-text"),p(s,"rows",10),p(o,"class","btn svelte-1tgt4dg"),p(e,"class","standard-dialog center")},m(i,_){k(i,e,_),u(e,t),u(e,n),u(e,s),R(s,l[0]),u(e,a),u(e,o),c||(r=[T(s,"input",l[12]),T(o,"click",l[8])],c=!0)},p(i,_){_&1&&R(s,i[0])},i:m,o:m,d(i){i&&w(e),c=!1,X(r)}}}function ae(l){let e,t,n,s,a,o;return{c(){e=d("div"),t=d("h1"),t.textContent="Send link to player #2",n=v(),s=d("textarea"),p(t,"class","dialog-text"),p(s,"rows",10),s.value=l[1],p(e,"class","standard-dialog center")},m(c,r){k(c,e,r),u(e,t),u(e,n),u(e,s),a||(o=Y(Z.call(null,s)),a=!0)},p(c,r){r&2&&(s.value=c[1])},i:m,o:m,d(c){c&&w(e),a=!1,o()}}}function oe(l){let e,t,n,s;const a=[ae,se,ne,te],o=[];function c(r,i){return r[2]==="new"?0:r[2]==="connecting"?1:r[2]==="connected"?2:3}return e=c(l),t=o[e]=a[e](l),{c(){t.c(),n=j()},m(r,i){o[e].m(r,i),k(r,n,i),s=!0},p(r,i){let _=e;e=c(r),e===_?o[e].p(r,i):(z(),b(o[_],1,1,()=>{o[_]=null}),W(),t=o[e],t?t.p(r,i):(t=o[e]=a[e](r),t.c()),C(t,1),t.m(n.parentNode,n))},i(r){s||(C(t),s=!0)},o(r){b(t),s=!1},d(r){o[e].d(r),r&&w(n)}}}function re(l){let e,t;return e=new q({props:{$$slots:{default:[oe]},$$scope:{ctx:l}}}),{c(){S(e.$$.fragment)},m(n,s){D(e,n,s),t=!0},p(n,[s]){const a={};s&65551&&(a.$$scope={dirty:s,ctx:n}),e.$set(a)},i(n){t||(C(e.$$.fragment,n),t=!0)},o(n){b(e.$$.fragment,n),t=!1},d(n){x(e,n)}}}function le(l,e,t){let n,s,a,o;const c=new J,{messages:r}=c;y(l,r,f=>t(3,o=f));const i=new B(1),{state:_}=i,g=new ee(c,i),{localDescription:E,connectionState:O}=g;y(l,E,f=>t(11,s=f)),y(l,O,f=>t(2,a=f));let h="";function L(){h&&g.setRemoteDescription(atob(h))}function M(f){if(f.detail){const $=f.detail;i.send($),g.sendMessage({type:"game",event:$})}}function A(f){if(f.detail){const $=f.detail;c.addMessage($),g.sendMessage({type:"chat",text:$})}}N(()=>{g.createDataChannel()});function G(){h=this.value,t(0,h)}return l.$$.update=()=>{l.$$.dirty&2048&&t(1,n=`${window.location.href}client.html?offer=${window.btoa(s)}`)},[h,n,a,o,r,_,E,O,L,M,A,s,G]}class ce extends F{constructor(e){super(),H(this,e,le,re,P,{})}}new ce({target:document.getElementById("app")});
